<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard ‚Äì Chatbot Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<script>
    // Injects the Python list into a JavaScript variable
    window.backendSearchSeed = {{ search_seed | tojson }};
</script>

<body id="page-dashboard">

    <aside class="sidebar">
        <h2>CRM Admin</h2>
        <a href="/dashboard" class="nav-link nav-dashboard active">Dashboard</a>
        <a href="/customers" class="nav-link nav-customers">Customer List</a>
        <a href="/templates-manager" class="nav-link nav-templates">Template Manager</a>
        <a href="/history" class="nav-link nav-history">Chat History</a>
        <a href="/repository" class="nav-link nav-repository">Inquiry Repository</a>
        <a href="/scoring" class="nav-link nav-scoring">Lead Scoring</a>
    </aside>

    <main class="main">
        <div class="header">
            <div class="header-left">
                <h1 style="margin:0; font-size: 24px;">Admin Dashboard</h1>
                <button class="btn btn-gray" data-bs-toggle="modal" data-bs-target="#customizeModal"
                    style="font-size: 12px;">‚öôÔ∏è Customize Stats</button>
            </div>
            <div class="search-container">
                <input type="text" placeholder="Search leads, rules, or customers..." class="taskbar-search">
            </div>
            <div class="header-right"></div>
        </div>

        <div class="row g-4 mb-4" id="metricsContainer">
            <div class="col-12 col-sm-6 col-xl-3">
                <div class="card" id="slot-0"></div>
            </div>
            <div class="col-12 col-sm-6 col-xl-3">
                <div class="card" id="slot-1"></div>
            </div>
            <div class="col-12 col-sm-6 col-xl-3">
                <div class="card" id="slot-2"></div>
            </div>
            <div class="col-12 col-sm-6 col-xl-3">
                <div class="card" id="slot-3"></div>
            </div>
        </div>

        <div class="card mb-4" style="padding: 25px;">
            <h3 style="margin-top:0; color: var(--slate-900); font-size: 1.1rem;">Highest Leads (Past 7 Days)</h3>
            <div style="height: 250px;">
                <canvas id="leadsChart"></canvas>
            </div>
        </div>

        <div class="row g-4">
            <div class="col-12 col-lg-7">
                <div class="card h-100">
                    <h3 style="margin-bottom: 20px; font-size: 1.1rem;">üî• High-Value Leads (Top 3)</h3>
                    <div id="highValueLeadsContainer"></div>
                </div>
            </div>

            <div class="col-12 col-lg-5">
                <div class="card h-100">
                    <h3 style="margin-bottom: 20px; font-size: 1.1rem;">üí¨ Latest Customer Chats</h3>
                    <div id="latestChatsContainer"></div>
                </div>
            </div>
        </div>
    </main>

    <div class="modal fade" id="customizeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <h5 class="modal-title fw-bold">Customize Dashboard</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="configForm">
                </div>
                <div class="modal-footer border-0 pt-0">
                    <button type="button" class="btn btn-blue w-100" onclick="saveDashboardConfig()">Save
                        Changes</button>
                    <button type="button" class="btn btn-gray w-100" data-bs-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>